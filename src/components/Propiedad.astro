---
const {
  title,
  price,
  description,
  amenities,
  floors,
  location,
  operation,
  publishedAt,
  img,
  slug,
  contacto = 'Brayant F',
  bedrooms,
  bathrooms,
  area,
  parking,
  status,
} = Astro.props;

import fallbackImage from "../assets/logo_regio_rentas.webp";
import Badge from "./Badge.astro";

const imageUrl = img ?? fallbackImage.src;
const whatsappMessage = `https://wa.me/521XXXXXXXXXX?text=Hola, estoy interesado en la propiedad "${title}"`;

const { colonia, estado, municipio } = location;

const fecha = new Date(publishedAt);
const fechaFormateada = fecha.toLocaleDateString("es-MX", {
  day: "2-digit",
  month: "long",
  year: "numeric",
});
---

<article
  class="flex flex-col md:flex-row gap-4 border border-slate-300 bg-gray-100 rounded-lg overflow-hidden hover:shadow-md transition duration-100 ease-in-out h-auto"
>
  <a href={`/propiedad/${slug}`} class="md:w-1/3 w-full">
    <img
      class="w-full h-full object-cover"
      src={imageUrl}
      alt={title}
      loading="lazy"
    />
  </a>
  <div class="md:w-2/3 h-max p-4 flex flex-col gap-3 box-content">
    <div class="flex justify-between">
      <a href={`/propiedad/${slug}`} class="font-bold text-xl hover:underline text-slate-700"
        >{title}</a
      >
    </div>
    <p class="text-lg text-red-800 font-semibold">${price} MXN</p>
    <p class="font-medium text-slate-600">{municipio + " " + estado + " " + colonia}</p>
    <p class="text-normal text-gray-700 line-clamp-2">{description}</p>


    <div class="flex gap-4">
      {amenities.map((amenidad: string) => <span class="text-xs font-medium bg-red-100 text-red-700 rounded-sm py-1 px-2">{amenidad}</span>)}
    </div>

    <div class="flex flex-wrap gap-2">
      <Badge icon="bed" label={bedrooms} />
      <Badge icon="bath" label={bathrooms} />
      <Badge icon="meter" label={`${area} mÂ²`} />
      <Badge icon="car" label={parking} />
      <Badge icon="floor" label={floors} />
    </div>

    <div class="flex flex-row justify-between items-center border-t border-slate-200 pt-3">
      <p class="font-medium text-sm text-slate-600">Publicado {fechaFormateada} - {contacto}</p>
      <a
        href={whatsappMessage}
        target="_blank"
        rel="noopener noreferrer"
        class="flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md"
      >
        <span>WhatsApp</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path stroke="none" d="M0 0h24v24H0z"></path>
          <path d="M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9"></path>
          <path
            d="M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1"
          ></path>
        </svg>
      </a>
    </div>
  </div>
</article>
